# 設定項目

---

<!-- ### General Setting (全体設定) -->

<img
src={require('/img/marshmallowPB/setup/Intro.png').default}
style={{ width: '80%' }}
/>

#### Language

言語を設定します。英語・韓国語・中国語（簡体字）に対応しています。

#### パラメータ初期化

設定中のパラメータをリセットします（アバタープリセットや胸ボーン設定は保持されます）。

---

### Basic Setting (基本設定)

<img
src={require('/img/marshmallowPB/setup/BasicSetting.png').default}
style={{ width: '80%' }}
/>

#### プリセット

アバターのプリセットを選択する場所です。  
プリセットが多くて見当たらない場合は、下の矢印を押して表示してください。

#### 胸ボーン

アバターの胸ボーンを選択します。

#### 胸の大きさ(blendshape)

対応アバターの場合は**胸を大きくするシェイプキー**の値を設定します。  
ただし、プリセット名にシェイプキー名がある場合は、その値を設定してください。  
非対応シェイプキーの場合は、非対応アバターと同様に設定してください。

#### 胸ボーンの Y スケール値(Transform)

胸ボーンの **Y スケール値**のみ入力してください（X・Z は不要）。  
XYZ のスケール値は異なっていても問題ありません。

---

### PhysBone Setting (PB 設定)

<img
src={require('/img/marshmallowPB/setup/PhysBoneSetting.png').default}
style={{ width: '80%' }}
/>

#### PB プリセット

PB のプリセットを選択します。  
初期プリセットには「なめらか」「ぷるぷる」「たゆんたゆん」の 3 種類があり、それぞれ硬さを 3 段階から選べます。  
後述のように、プリセットは追加も可能です。

#### Pull（形状を戻す強さ）

PB が元の形状に戻ろうとする強さを調整します。

#### Momentum（ばねの強さ）

PB のばねの強さを調整します。

#### Stiffness（屈曲剛性／ブレやすさ）

PB の曲がりにくさ（ブレにくさ）を調整します。

#### Gravity（重力の強さ）

PB にかかる重力の強さを調整します。  
※初期値以上にすると破綻する場合があります。

#### GravityFalloff（重力に対する形状の保持）

PB が重力に対してどれだけ形状を保つかを調整します。  
初期角度からずれると効果が弱まり、重力の影響が強くなります。

#### Immobile（動きにくさ）

PB の動きにくさを調整します。  
コライダーを手で押した際の動作には影響しません。

#### ImmobileType（動きにくさの種類）

PB の動きにくさのタイプです。  
Allmotion は全動作、World はスティック移動・ジャンプに Immobile の値が適用されます。  
World では通常の動作の Immobile が強制的に 0 となるため、基本的には Allmotion を使用してください。

#### LimitAngle（角度制限）

PB の可動角度の上限を設定します。

#### LimitRotation（角度オフセット）

PB の可動角度のオフセットを設定します。  
XYZ ごとに設定でき、左右対称に適用されます。

#### CollisionRadius（コライダーの大きさ）

コライダーの大きさを設定します。

#### AllowCollision（触り許可）

ましゅまろ PB に触れる権限（自分・他人）を設定します。

#### StretchMotion（伸縮のしやすさ）

PB の動きによるつぶれやすさ、のびやすさ（慣性）を調整します。  
値が大きいと、前進後退時に胸が慣性で強く変形します。

#### MaxStretch（最大伸び）

PB の最大伸び量を設定します。  
値が大きいと掴んだ際に胸が長く伸びます。
0 にすると伸び機能が無効化されます。

#### MaxSquish（最大つぶれ）

PB の最大つぶれ量を設定します。  
値が大きいと胸が深くつぶれ、小さいと浅くなり服の貫通が起きにくくなります。  
0 にするとつぶれ機能が無効化されます。

#### AllowGrabbing（掴み許可）

ましゅまろ PB を掴める権限（自分・他人）を設定します。

#### AllowPosing（固定許可）

ましゅまろ PB を固定できる権限（自分・他人）を設定します。

#### GrabMovement（掴み挙動）

掴んで動かした際の追従性を調整します。  
値が大きいほど手に追従しやすくなります。

#### SnapToHand（掴み時のスナップ）

掴んだ際に手へどの程度スナップするかを調整します。  
値が大きいほど強くスナップされます。

#### Collider

PB に干渉するコライダーを最大 10 箇所まで設定できます。  
一部プリセットでは自動設定されます。（例：腕コライダー）

---

### Inertia Setting (慣性／疑似多重ボーン設定)

<img
src={require('/img/marshmallowPB/setup/InertiaSetting.png').default}
style={{ width: '80%' }}
/>

#### Inertia（慣性／疑似多重ボーン）有効化

Inertia（慣性／疑似多重ボーン）機能を有効化します。  
有効時は、揺れた際にメインボーンの動きに加え、慣性によって揺れが残るような挙動が追加されます。

#### 各種パラメータ

Physbone と同様です。  
揺れの残り方は、メインボーンの PB 設定に対する慣性/疑似多重ボーンの PB 設定で相対的に決まります。  
基本的に、Pull、Momentum、Stiffness、Immobile を変更すれば問題ありません。

---

### Parallel Bone Setting (平行ボーン設定)

<img
src={require('/img/marshmallowPB/setup/ParallelBoneSetting.png').default}
style={{ width: '80%' }}
/>

#### 平行ボーン機能 有効化

平行ボーン機能を有効化します。  
有効時は胸ボーンが平行化され、より重量感のある挙動になります。

#### 平行度（縦方向）

胸ボーンの縦方向の平行度を設定します。  
胴体に対して縦方向は広く接しているため、横方向より高めの値が適切です。

#### 平行度（横方向）

胸ボーンの横方向の平行度を設定します。

#### つぶれ時の平行度強化（縦方向）

胸がつぶれた際に、縦方向の平行度をどの程度強化するかを設定します。  
つぶれた状態では角度の変化が抑えられ、平行度がより強調されます。

#### つぶれ時の平行度強化（横方向）

胸がつぶれた際に、横方向の平行度をどの程度強化するかを設定します。

---

### Gravity Setting (重力設定)

<img
src={require('/img/marshmallowPB/setup/GravitySetting.png').default}
style={{ width: '80%' }}
/>

#### 重力機能 有効化

重力機能を有効化します。  
有効時は胸ボーンが上向き（仰向け）でつぶれ、下向きで垂れ下がるようになります。

#### つぶれやすさ

胸ボーンの重力によるつぶれ最大値を設定します。  
値が大きいと深くつぶれ、0 でつぶれなくなります。

#### 垂れ下がりやすさ

胸ボーンの重力による垂れ下がり最大値を設定します。  
値が大きいと長く伸び、0 で垂れ下がりません。

#### 乳流れ角度（つぶれ時）

重力でつぶれた際、胸ボーンが外側へ流れる角度を設定します。

#### 乳流れ角度（垂れ下がり時）

重力で垂れ下がった際、胸ボーンが内側へ寄る角度を設定します。

---

### Interference/Squish Setting (干渉/つぶれ設定)

<img
src={require('/img/marshmallowPB/setup/InterferenceSquishSetting.png').default}
style={{ width: '80%' }}
/>

#### つぶれアニメーションの強さ

胸のつぶれアニメーションの強さを調整します。  
胸が大きい場合、横方向につぶれすぎるのを防ぐにはこの値を小さくしてください。  
（胸ボーンの Scale Constraint の Weight に相当します）

#### 横つぶれアニメーションの強さ（両胸干渉時）

両胸を寄せた際の横つぶれアニメーションの強さを調整します。

#### 両胸同士の干渉

左右の胸同士で干渉コライダーを設置するか設定します。

#### 干渉コライダーの大きさ

左右の胸同士で干渉するコライダーの大きさを設定します。

#### 他プレイヤーとの胸干渉

他プレイヤーのましゅまろ PB と胸同士で干渉する機能を設定します。  
胸以外に頭のデフォルトコライダーとも干渉可能です。  
メニューからもオンオフできます。

#### 床コライダー

床コライダーと干渉するか設定します。  
うつ伏せ時などに胸が潰れるようになります。

---

### Anti-Penetration Setting (貫通防止設定)

<img
src={require('/img/marshmallowPB/setup/AntiPenetrationSetting.png').default}
style={{ width: '80%' }}
/>

#### つぶれ制限コライダーの位置

つぶれを制限するコライダーの位置を設定します。  
値が大きいほどつぶれにくくなります。  
通常の胸ボーンのつぶれと重力によるつぶれは加算されるため、貫通防止用に設置されています。

#### 貫通防止用システム

貫通防止用システムを有効化します。  
両胸ボーンが相互に追従し、片方だけが動くことでの貫通を防ぎます。  
メニューからもオンオフできます。

#### つぶれ機能無効化

ましゅまろ PB のつぶれ機能を無効化します。  
メニューからもオンオフできます。

#### 両胸干渉時の回転機能

両胸干渉時の回転機能を有効化します。  
両胸を寄せた際、ボーンをわずかに内側へ回転させて貫通を防ぎます。

---

### Menu Setting (メニュー設定)

<img
src={require('/img/marshmallowPB/setup/MenuSetting.png').default}
style={{ width: '80%' }}
/>

#### ましゅまろ PB 用メニュー生成

ましゅまろ PB 用の操作メニューを生成します。  
「他プレイヤーとの胸干渉」「貫通防止用システム」「つぶれ機能無効化」「通常 PB に変更」「PB 無効化」の機能をオンオフできます。

#### メニューインストール先（変更する場合）

メニューのインストール先を変更できます。  
未指定時は最上層に追加されます。

---

### Advanced Setting (高度な設定)

<img
src={require('/img/marshmallowPB/setup/AdvancedSetting.png').default}
style={{ width: '80%' }}
/>

#### チェストボーンベースでプリセットを適用

チェストボーンを基準にプリセットを適用します。  
チェストボーンとの相対位置を取るため、Unity 上でアバターの体形や位置を変更しても正常に適用できます。  
blender 等で大幅なボーン変更がある場合は、非対応アバターとして設定してください。

#### オブジェクトにこの Transform を適用

ましゅまろ PB の位置・回転・スケールのオフセットとして marshmallow_PB_Setup の位置を使用します。  
ヒール等でアバターの位置が上方向に移動する場合、通常プリセットではましゅまろ PB の位置がズレます。  
その際はこの機能をオンにし、marshmallow_PB_Setup を同じだけ上方向に移動してください。  
多くの場合「チェストボーンベースでプリセットを適用」だけで十分ですが、ズレる場合はこの機能で調整できます。

#### 配下の PB を全削除

設定した胸ボーン配下の PB をすべて削除します。  
通常は胸ボーン直下の PB のみ削除されますが、非対応アバター等で複雑な構造の場合はこのオプションをオンにしてください。

#### つぶれ機能のみ適用（元の PB を使用）

アバターの元の PB を保持したまま、ましゅまろ PB のつぶれ機能のみを適用します。  
この場合、ましゅまろ PB の揺れ機能は無効化され、元の PB がそのまま使われます。  
この設定を使う場合は、元の PB の Allow Grabbing をオフにしてください。

---

### PB Preset Setting (PB プリセット設定)

<img
src={require('/img/marshmallowPB/setup/PBPresetSetting.png').default}
style={{ width: '80%' }}
/>

#### Import

入力した PB コードを読み込み、PB 設定に反映します。  
PB 設定は揺れ方に関与する Physbone、Inertia、Parallel Bone の設定を保持します。（角度制限・触り許可等は除く）

#### Export

現在の PB 設定を PB コードに変換します。  
このコードを共有することで、ましゅまろ PB の設定を簡単に共有できます。

#### Save

現在の PB 設定を PB プリセットとして保存します。  
保存した設定は PB プリセット項目に追加されます。
